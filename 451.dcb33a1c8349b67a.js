"use strict";(self.webpackChunksk_planes=self.webpackChunksk_planes||[]).push([[451],{4451:(K,v,l)=>{l.r(v),l.d(v,{FlightsModule:()=>H});var d=l(9808),T=l(6534),s=l(3075),m=l(1402),t=l(5e3),c=l(8966),F=l(4004),w=l(5197);let p=(()=>{class i{constructor(e){this.db=e,this.API_URL="/flights"}getFlights(){return this.db.list(this.API_URL).snapshotChanges().pipe((0,F.U)(e=>e.map(i.assignKey)))}static assignKey(e){return Object.assign(Object.assign({},e.payload.val()),{key:e.key})}addFlight(e){return this.db.list(this.API_URL).push(e)}getFlight(e){return this.db.object(`${this.API_URL}/${e}`).snapshotChanges().pipe((0,F.U)(o=>i.assignKey(o)))}editFlight(e,o){return this.db.object(`${this.API_URL}/${e}`).update(o)}removeFlight(e){return this.db.object(`${this.API_URL}/${e}`).remove()}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(w.KQ))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var _=l(1271),x=l(655);const y=i=>i.value.startsWith("SK")?null:{incorrectCode:!0};var f=l(7322),A=l(7531),M=l(7446),h=l(8099),g=l(7423);function U(i,n){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Code is required"),t.qZA())}function k(i,n){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Minimum length is 4 characters"),t.qZA())}function I(i,n){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Maximum length is 7 characters"),t.qZA())}function N(i,n){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Code must start with SK prefix"),t.qZA())}function O(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div",16)(1,"div",17)(2,"div",13)(3,"span"),t._uU(4),t.qZA(),t.TgZ(5,"mat-icon",18),t.NdJ("click",function(){const a=t.CHM(e).index;return t.oxw().removeCrewMember(a)}),t._uU(6,"delete_forever"),t.qZA()()(),t.TgZ(7,"div",1)(8,"div",13)(9,"button",19),t.NdJ("click",function(){return t.CHM(e),t.oxw().addCrewMember()}),t._uU(10,"Add crew member"),t.qZA()()()()}if(2&i){const e=n.index;t.xp6(4),t.hij("Crew member - ",e+1,"")}}let C=(()=>{class i{constructor(e){this.formBuilder=e,this.editMode=!1,this.jobs=[{label:"Stewardess",value:"stewardess"},{label:"Senior Cabin Crew",value:"senior_cabin_crew"},{label:"Pilot",value:"pilot"},{label:"Co-pilot",value:"co_pilot"},{label:"Mechanic",value:"mechanic"}]}ngOnInit(){this.buildForm()}addCrewMember(e){this.crew.push(this.buildCrewMember(e))}buildCrewMember(e={}){return this.formBuilder.group({name:e.name||"",job:e.job||""})}removeCrewMember(e){this.crew.removeAt(e)}get crew(){return this.form.get("crew")}buildForm(){this.form=this.formBuilder.group({origin:["",{validators:[s.kI.required]}],destination:["",{validators:[s.kI.required]}],departureTime:["",{validators:[s.kI.required]}],returnTime:["",{validators:[s.kI.required]}],code:["SK",{validators:[s.kI.required,s.kI.minLength(4),s.kI.maxLength(7),y]}],additionalInformation:"",withSKPlanesDiscount:!1,crew:this.formBuilder.array(this.editMode?[]:[this.buildCrewMember()])})}setFlight(e){const r=(0,x._T)(e,["key"]);this.form.patchValue(r),r.crew.forEach(a=>this.addCrewMember(a))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(s.qu))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-flight-form"]],inputs:{editMode:"editMode"},decls:35,vars:7,consts:[[3,"formGroup"],[1,"row"],[1,"col-sm-4"],["matInput","","formControlName","code","placeholder","Code"],["codeInput",""],[4,"ngIf"],["align","end"],["matInput","","formControlName","origin","placeholder","Origin"],["matInput","","formControlName","destination","placeholder","Destination"],["matInput","","formControlName","departureTime","placeholder","Departure time"],["matInput","","formControlName","returnTime","placeholder","Return time"],[1,"col-sm-8"],["matInput","","formControlName","additionalInformation","placeholder","Additional information"],[1,"col"],["formControlName","withSKPlanesDiscount"],["formArrayName","crew","class","crew-container shadow",4,"ngFor","ngForOf"],["formArrayName","crew",1,"crew-container","shadow"],[1,"row","crew-header"],[1,"float-end",3,"click"],["mat-raised-button","","color","primary",3,"click"]],template:function(e,o){if(1&e&&(t.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"mat-form-field"),t._UZ(4,"input",3,4),t.YNc(6,U,2,0,"mat-error",5),t.YNc(7,k,2,0,"mat-error",5),t.YNc(8,I,2,0,"mat-error",5),t.YNc(9,N,2,0,"mat-error",5),t.TgZ(10,"mat-hint",6),t._uU(11),t.qZA()()()(),t.TgZ(12,"div",1)(13,"div",2)(14,"mat-form-field"),t._UZ(15,"input",7),t.qZA()(),t.TgZ(16,"div",2)(17,"mat-form-field"),t._UZ(18,"input",8),t.qZA()()(),t.TgZ(19,"div",1)(20,"div",2)(21,"mat-form-field"),t._UZ(22,"input",9),t.qZA()(),t.TgZ(23,"div",2)(24,"mat-form-field"),t._UZ(25,"input",10),t.qZA()()(),t.TgZ(26,"div",1)(27,"div",11)(28,"mat-form-field"),t._UZ(29,"textarea",12),t.qZA()()(),t.TgZ(30,"div",1)(31,"div",13)(32,"mat-checkbox",14),t._uU(33,"With SK Discount"),t.qZA()()(),t.YNc(34,O,11,1,"div",15),t.qZA()),2&e){const r=t.MAs(5);let a,u,Z,b;t.Q6J("formGroup",o.form),t.xp6(6),t.Q6J("ngIf",null==(a=o.form.get("code"))?null:a.hasError("required")),t.xp6(1),t.Q6J("ngIf",null==(u=o.form.get("code"))?null:u.hasError("minLength")),t.xp6(1),t.Q6J("ngIf",null==(Z=o.form.get("code"))?null:Z.hasError("maxLength")),t.xp6(1),t.Q6J("ngIf",null==(b=o.form.get("code"))?null:b.hasError("incorrectCode")),t.xp6(2),t.hij("",r.value.length," / 7"),t.xp6(23),t.Q6J("ngForOf",o.crew.controls)}},directives:[s._Y,s.JL,s.sg,f.KE,A.Nt,s.Fj,s.JJ,s.u,d.O5,f.TO,f.bx,M.oG,d.sg,s.CE,h.Hw,g.lW],styles:["form[_ngcontent-%COMP%]{padding-bottom:25px}mat-form-field[_ngcontent-%COMP%]{width:100%}.crew-container[_ngcontent-%COMP%]{margin-top:15px;padding:15px;background-color:#fff}.crew-haeder[_ngcontent-%COMP%]{margin-bottom:20px;font-weight:700}"]}),i})();const q=["flightForm"];let E=(()=>{class i{constructor(e,o,r){this.dialogRef=e,this.flightsService=o,this.toast=r}ngOnInit(){}createFlight(){var e;this.flightsService.addFlight(null===(e=this.flightForm)||void 0===e?void 0:e.form.value).then(this.onCreatingSuccess.bind(this),this.onCreatingFailure.bind(this))}onCreatingSuccess(){this.dialogRef.close(),this.toast.open("Flight has been successfully created","",{panelClass:"toast-success"})}onCreatingFailure(e){this.toast.open(e.message,"",{panelClass:"toast-error"})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(c.so),t.Y36(p),t.Y36(_.ux))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-new-flight"]],viewQuery:function(e,o){if(1&e&&t.Gf(q,5),2&e){let r;t.iGM(r=t.CRH())&&(o.flightForm=r.first)}},decls:12,vars:1,consts:[["mat-dialog-title",""],["flightForm",""],[1,"row"],[1,"col"],["mat-raised-button","","mat-dialog-close",""],["mat-raised-button","","color","primary",3,"disabled","click"]],template:function(e,o){if(1&e&&(t.TgZ(0,"h2",0),t._uU(1,"New Flight Creator"),t.qZA(),t.TgZ(2,"mat-dialog-content"),t._UZ(3,"app-flight-form",null,1),t.qZA(),t.TgZ(5,"mat-dialog-actions")(6,"div",2)(7,"div",3)(8,"button",4),t._uU(9,"Cancel"),t.qZA(),t.TgZ(10,"button",5),t.NdJ("click",function(){return o.createFlight()}),t._uU(11,"Create"),t.qZA()()()()),2&e){const r=t.MAs(4);t.xp6(10),t.Q6J("disabled",r.form.invalid)}},directives:[c.uh,c.xY,C,c.H8,g.lW,c.ZT],styles:[""]}),i})();function S(i,n){if(1&i&&(t.TgZ(0,"li"),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.xp6(1),t.hij(" ",e.name," ")}}let J=(()=>{class i{constructor(e,o,r){this.dialogRef=e,this.data=o,this.router=r,this.flight=o}closeDialog(){this.dialogRef.close()}goToEditFlight(){this.closeDialog(),this.router.navigate(["/dashboard/flights",this.flight.key])}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(c.so),t.Y36(c.WI),t.Y36(m.F0))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-details"]],decls:14,vars:2,consts:[[1,"row"],[1,"col"],[1,"float-end",3,"click"],[1,"label"],[4,"ngFor","ngForOf"],["mat-raised-button","","color","primary",1,"float-end",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h3"),t._uU(3," FLIGHT DETAILS "),t.TgZ(4,"mat-icon",2),t.NdJ("click",function(){return o.closeDialog()}),t._uU(5,"close"),t.qZA()(),t.TgZ(6,"p",3),t._uU(7),t.qZA(),t.TgZ(8,"p",3),t._uU(9,"Crew:"),t.qZA(),t.TgZ(10,"ul"),t.YNc(11,S,2,1,"li",4),t.qZA(),t.TgZ(12,"button",5),t.NdJ("click",function(){return o.goToEditFlight()}),t._uU(13,"EDIT FLIGHT"),t.qZA()()()),2&e&&(t.xp6(7),t.hij("Code: ",o.flight.code,""),t.xp6(4),t.Q6J("ngForOf",o.flight.crew))},directives:[h.Hw,d.sg,g.lW],styles:[""]}),i})(),P=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-flight-card"]],inputs:{flight:"flight"},decls:15,vars:4,consts:[[1,"card-container"],[1,"card-content","shadow"],[1,"row"],[1,"col"],[1,"origin"],[1,"destination"],[1,"time"],[1,"icon-container","shadow"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"p",4),t._uU(5),t.qZA(),t.TgZ(6,"p",5),t._uU(7),t.qZA()()(),t.TgZ(8,"div",2)(9,"div",3)(10,"p",6),t._uU(11),t.qZA()()()(),t.TgZ(12,"div",7)(13,"mat-icon"),t._uU(14,"airplanemode_active"),t.qZA()()()),2&e&&(t.xp6(5),t.Oqu(o.flight.origin),t.xp6(2),t.Oqu(o.flight.destination),t.xp6(4),t.AsE("",o.flight.departureTime," - ",o.flight.returnTime,""))},directives:[h.Hw],styles:["[_nghost-%COMP%]{cursor:pointer}.card-container[_ngcontent-%COMP%]{padding:10px;margin-bottom:20px;position:relative}.card-content[_ngcontent-%COMP%]{padding:30px 20px;background-color:#fff}.icon-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;left:50%;top:-10px;height:50px;width:50px;background-color:#fff;border-radius:50%;z-index:10;border:1px solid grey;transform:translate(-50%)}.icon-container[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#00008b}.time[_ngcontent-%COMP%]{text-align:center;font-size:13px;color:gray}.origin[_ngcontent-%COMP%], .destination[_ngcontent-%COMP%]{font-size:26px;font-weight:700;color:#ff1493}"],changeDetection:0}),i})();function Y(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div",3),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw().showDetails(a)}),t._UZ(1,"app-flight-card",4),t.qZA()}if(2&i){const e=n.$implicit;t.xp6(1),t.Q6J("flight",e)}}let D=(()=>{class i{constructor(e,o){this.flightsService=e,this.dialog=o,this.flights$=this.flightsService.getFlights()}openNewFlightModal(){this.dialog.open(E)}showDetails(e){this.dialog.open(J,{data:e})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(p),t.Y36(c.uw))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-flights"]],decls:5,vars:3,consts:[[1,"row","flights-container"],["class","col-sm-4",3,"click",4,"ngFor","ngForOf"],["mat-fab","","color","accent","id","new-flight-btn",3,"click"],[1,"col-sm-4",3,"click"],[3,"flight"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t.YNc(1,Y,2,1,"div",1),t.ALo(2,"async"),t.qZA(),t.TgZ(3,"button",2),t.NdJ("click",function(){return o.openNewFlightModal()}),t._uU(4,"+"),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngForOf",t.lcZ(2,1,o.flights$)))},directives:[d.sg,P,g.lW],pipes:[d.Ov],styles:[".flights-container[_ngcontent-%COMP%]{padding-top:30px}#new-flight-btn[_ngcontent-%COMP%]{position:fixed;bottom:50px;right:50px;font-size:30px}"]}),i})();var R=l(8505);const j=["flightForm"],L=[{path:"",component:D},{path:":key",component:(()=>{class i{constructor(e,o,r,a){this.route=e,this.router=o,this.flightsService=r,this.toast=a}ngAfterViewInit(){this.loadFlight()}loadFlight(){this.flightsService.getFlight(this.route.snapshot.params.key).pipe((0,R.b)(o=>this.flightForm.setFlight(o))).subscribe(o=>this.flight=o)}editFlight(){var e;this.flightsService.editFlight(null===(e=this.flight)||void 0===e?void 0:e.key,this.flightForm.form.value).then(this.onEditSuccess.bind(this),this.onError.bind(this))}onEditSuccess(){this.router.navigate(["/dashboard"]),this.toast.open("Flight has been seccessfully edited","",{panelClass:"toast-success"})}onError(e){this.toast.open(e.message,"",{panelClass:"toast-error"})}removeFlight(){var e;this.flightsService.removeFlight(null===(e=this.flight)||void 0===e?void 0:e.key).then(this.onRemoveSuccess.bind(this),this.onError.bind(this))}onRemoveSuccess(){this.router.navigate(["/dashboard"]),this.toast.open("Flight has been seccessfully removed","",{panelClass:"toast-success"})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(m.gz),t.Y36(m.F0),t.Y36(p),t.Y36(_.ux))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-edit-flight"]],viewQuery:function(e,o){if(1&e&&t.Gf(j,5),2&e){let r;t.iGM(r=t.CRH())&&(o.flightForm=r.first)}},decls:18,vars:2,consts:[[1,"row"],[1,"col-9"],[1,"col-3"],["id","remove-btn",1,"float-end",3,"click"],[3,"editMode"],["flightForm",""],[1,"col","text-end"],["mat-raised-button",""],["mat-raised-button","","color","primary",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h3"),t._uU(3,"Edit flight "),t.TgZ(4,"strong"),t._uU(5),t.qZA(),t._uU(6," details"),t.qZA()(),t.TgZ(7,"div",2)(8,"mat-icon",3),t.NdJ("click",function(){return o.removeFlight()}),t._uU(9,"delete_forever"),t.qZA()()(),t._UZ(10,"app-flight-form",4,5),t.TgZ(12,"div",0)(13,"div",6)(14,"button",7),t._uU(15,"RESET"),t.qZA(),t.TgZ(16,"button",8),t.NdJ("click",function(){return o.editFlight()}),t._uU(17,"SAVE"),t.qZA()()()),2&e&&(t.xp6(5),t.Oqu(null==o.flight?null:o.flight.code),t.xp6(5),t.Q6J("editMode",!0))},directives:[h.Hw,C,g.lW],styles:["#remove-btn[_ngcontent-%COMP%]{color:red;cursor:pointer;font-size:42px;padding-top:15px}"]}),i})()}];let Q=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[m.Bz.forChild(L)],m.Bz]}),i})(),H=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[d.ez,T.q,s.u5,s.UX,Q]]}),i})()}}]);